```json lw-blog-meta
{"title":"OS学习笔记46：持久化：小结","date":"2019-09-09","brev":"章节小结。","tags":["OS"],"path":"blog/2019/190909-OS学习笔记46.md"}
```



# 第四六章 <Summary Dialogue on Persistencen>

[PDF链接](http://pages.cs.wisc.edu/~remzi/OSTEP/file-dialogue.pdf)

## 我的理解

### 持久化与数据准确性

总的来说，管理持久化的数据，比管理非持久化的数据（内存中的）要复杂的多。

非持久化的数据，其实就是电压的高低（0/1信号）而已；将数据持久化，其实就是对某种介质物质施加造成永久的性质改变的过程。
而要对真实的物理世界造成影响，被施加的介质自然会有更大的抵抗力，（或者说，介质物质为了能够保持自身性质不变，会有一定强度的抵抗力）。因此需要更加强劲的工具。而这种强劲的写入于强劲的抵抗之间，偶尔发生的意外，就是我们在本章节中介绍的各种异常情况。  

而另一方面，我们对于数据的要求是精确到bit的，任何一次偶然的故障都会是致命的。因此我们不得不研究各种算法来保证数据的正确性。

要保证数据的正确性，最关键的、也是最必须的概念就是：冗余。

而冗余必然带来性能问题，如何在时间与空间上进行优化，就是我们数据持久化章节中的重要讲解内容。

### 设备驱动与文件系统

首先，由于硬盘等IO设备太慢，因此在硬件主板的角度，有了**通用总线**。

然后，由于设备的设计、结构各不相同，从OS的角度，抽象了一个**驱动层**，向上提供标准接口。

驱动层只是代表了设备，在驱动层上面还要抽象一层**文件系统**。应用程序一般建立在文件系统之上。文件系统早期思路是类似于内存的虚拟化，有一个地址映射表维护在头部；后来发展了日志文件系统，滚动循环利用空间。

为了提升性能，在OS层面会有缓冲。

为了减轻OS负担，设备内部会有一些固件芯片帮助完成一些性能优化功能。

### 硬盘的分类与特性

目前主流的就是两种，机械硬盘HHD与固态硬盘SSD。

机械硬盘有机械结构，因此有定位时间；优势是价格便宜。固态硬盘性能碾压机械硬盘，但是有擦写寿命限制，价格也较高。
